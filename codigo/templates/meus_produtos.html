{% extends 'base.html' %}

{% block title %}Meus Produtos - Mercado Preso{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>Meus Produtos</h1>
        <p>Gerencie todos os produtos que vocÃª estÃ¡ vendendo</p>
        <a href="{{ url_for('compra.adicionar_produto') }}" class="btn btn-primary">
            + Adicionar Novo Produto
        </a>
    </div>

    {% if produtos %}
        <div class="products-grid">
            {% for produto in produtos %}
            <div class="product-card">
                <div class="product-image">
                    <img src="{{ url_for('static', filename='uploads/produtos/' + produto.imagem) if produto.imagem else url_for('static', filename='images/default-product.jpg') }}" 
                         alt="{{ produto.nome }}">
                    <div class="product-stock-badge">
                        {{ produto.quantidade }} em estoque
                    </div>
                </div>
                
                <div class="product-info">
                    <h3 class="product-name">{{ produto.nome }}</h3>
                    <p class="product-description">{{ produto.descricao|truncate(100) }}</p>
                    
                    <div class="product-details">
                        <span class="product-price">R$ {{ "%.2f"|format(produto.preco) }}</span>
                        <span class="product-sales">
                            1k vendas
                        </span>
                    </div>
                    
                    <div class="product-actions">
                        <a href="{{ url_for('compra.ver_produto', produto_id=produto.produto_id) }}" 
                           class="btn btn-secondary btn-sm">
                            Ver
                        </a>
                        <a href="{{ url_for('home') }}" 
                           class="btn btn-primary btn-sm">
                            Editar
                        </a>
                        <form action="{{ url_for('home')}}" 
                              method="POST" class="delete-form">
                            <button type="submit" class="btn btn-danger btn-sm" 
                                    onclick="return confirm('Tem certeza que deseja excluir este produto?')">
                                Excluir
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="products-summary">
            <div class="summary-card">
                <h3>Resumo</h3>
                <div class="summary-stats">
                    <div class="stat-item">
                        <span class="stat-number">{{ produtos|length }}</span>
                        <span class="stat-label">Produtos Cadastrados</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">
                            {{ produtos|sum(attribute='quantidade') }}
                        </span>
                        <span class="stat-label">Total em Estoque</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">
                            1k
                        </span>
                        <span class="stat-label">Vendas Totais</span>
                    </div>
                </div>
            </div>
        </div>
    {% else %}
        <div class="empty-state">
            <div class="empty-icon">ðŸ“¦</div>
            <h2>VocÃª ainda nÃ£o tem produtos cadastrados</h2>
            <p>Comece a vender adicionando seu primeiro produto!</p>
            <a href="{{ url_for('compra.adicionar_produto') }}" class="btn btn-primary">
                Adicionar Primeiro Produto
            </a>
        </div>
    {% endif %}
</div>
{% endblock %}